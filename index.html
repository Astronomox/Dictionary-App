<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dictionary App</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“–</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s, color 0.3s;
            background-color: #f9fafb;
            color: #111827;
        }
        .skeleton {
            animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 transition-colors duration-300">
    <div class="container mx-auto p-4 md:p-8 flex flex-col items-center min-h-screen">
        <header class="w-full max-w-2xl flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold">English Dictionary</h1>
        </header>

        <div class="w-full max-w-2xl mb-4">
            <div class="relative">
                <input type="text" id="wordInput" placeholder="Type a word..." class="w-full p-4 pl-12 pr-4 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 shadow-md">
                <button id="searchButton" class="absolute inset-y-0 right-0 flex items-center pr-4 text-gray-400 hover:text-indigo-500 transition-colors duration-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </button>
            </div>
        </div>

        <div id="historyContainer" class="w-full max-w-2xl mb-8 hidden">
            <div class="flex items-center justify-between mb-2">
                <h2 class="text-sm font-semibold text-gray-500">Recent Searches</h2>
                <button id="clearHistoryBtn" class="text-xs text-indigo-500 hover:text-indigo-700 transition-colors duration-200">Clear History</button>
            </div>
            <div id="historyList" class="flex flex-wrap gap-2"></div>
        </div>

        <div id="contentArea" class="w-full max-w-2xl flex flex-col items-center">
            <div id="initialState" class="text-center text-gray-500 p-8">
                <span class="text-8xl mb-4 block">ðŸ“–</span>
                <p class="text-lg">Search for any word to see its definition.</p>
            </div>
        </div>
    </div>

    <div id="messageBox" class="fixed top-4 left-1/2 -translate-x-1/2 bg-red-500 text-white p-4 rounded-lg shadow-xl hidden z-50 transition-transform duration-300">
        <p id="messageText"></p>
    </div>

    <footer class="w-full text-center p-4 bg-black text-white">
        ASTRONOMOXâ„¢
    </footer>

    <script>
        const getById = (id) => document.getElementById(id);

        const showMessage = (text) => {
            const messageBox = getById('messageBox');
            const messageText = getById('messageText');
            messageText.textContent = text;
            messageBox.classList.remove('hidden');
            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, 3000);
        };

        const createEl = (tag, classes = [], content = '') => {
            const el = document.createElement(tag);
            el.className = classes.join(' ');
            el.innerHTML = content;
            return el;
        };

        const clearContentArea = () => getById('contentArea').innerHTML = '';

        const showLoadingState = () => {
            clearContentArea();
            const loadingHtml = `
                <div class="w-full bg-white rounded-2xl shadow-lg p-6 animate-pulse">
                    <div class="flex items-center mb-4">
                        <div class="h-8 bg-gray-300 rounded w-1/3 mr-4"></div>
                        <div class="h-6 w-16 bg-gray-300 rounded"></div>
                        <div class="ml-auto w-10 h-10 bg-gray-300 rounded-full"></div>
                    </div>
                    <div class="space-y-4">
                        <div class="h-4 bg-gray-300 rounded w-full"></div>
                        <div class="h-4 bg-gray-300 rounded w-3/4"></div>
                        <div class="h-4 bg-gray-300 rounded w-1/2"></div>
                    </div>
                </div>
            `;
            getById('contentArea').innerHTML = loadingHtml;
        };

        const showErrorState = (word) => {
            clearContentArea();
            const errorHtml = `
                <div class="text-center p-8">
                    <svg class="w-24 h-24 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.5-1.748 1.632-3.076l-6.928-11.472a1.996 1.996 0 00-3.264 0L4.29 16.924C3.42 18.252 4.38 20 5.92 20z"></path>
                    </svg>
                    <h2 class="text-2xl font-semibold mb-2">Word not found</h2>
                    <p class="text-gray-500">Sorry, we couldn't find any definitions for "${word}". Please check the spelling or try another word.</p>
                </div>
            `;
            getById('contentArea').innerHTML = errorHtml;
        };

        const HISTORY_KEY = 'searchHistory';
        
        const saveSearchHistory = (word) => {
            const history = JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');
            const newHistory = [word, ...history.filter(w => w !== word)];
            localStorage.setItem(HISTORY_KEY, JSON.stringify(newHistory.slice(0, 5)));
        };

        const renderSearchHistory = () => {
            const historyContainer = getById('historyContainer');
            const historyList = getById('historyList');
            historyList.innerHTML = '';
            const history = JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');
            if (history.length > 0) {
                historyContainer.classList.remove('hidden');
                history.forEach(word => {
                    const btn = createEl('button', ['px-3', 'py-1', 'rounded-full', 'bg-gray-200', 'text-sm', 'text-gray-600', 'hover:bg-gray-300', 'transition-colors', 'duration-200']);
                    btn.textContent = word;
                    btn.onclick = () => { getById('wordInput').value = word; fetchWordDefinition(word); };
                    historyList.appendChild(btn);
                });
            } else historyContainer.classList.add('hidden');
        };

        const clearSearchHistory = () => { localStorage.removeItem(HISTORY_KEY); renderSearchHistory(); };

        const fetchWordDefinition = async (word) => {
            if (!word) { showMessage('Please enter a word to search.'); return; }
            showLoadingState();
            try {
                const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
                if (!response.ok) { if(response.status===404) { showErrorState(word); return;} throw new Error(); }
                const data = await response.json();
                renderWordData(data[0]);
                saveSearchHistory(word);
            } catch { showErrorState(word); }
        };

        const renderWordData = (data) => {
            clearContentArea();
            const contentArea = getById('contentArea');
            const card = createEl('div', ['w-full', 'bg-white', 'rounded-2xl', 'shadow-lg', 'p-6', 'md:p-8']);
            contentArea.appendChild(card);

            const header = createEl('div', ['flex', 'flex-col', 'sm:flex-row', 'sm:items-center', 'sm:justify-between', 'mb-6']);
            card.appendChild(header);

            const wordAndPhonetics = createEl('div', ['flex', 'flex-col', 'sm:flex-row', 'sm:items-center', 'mb-4', 'sm:mb-0']);
            header.appendChild(wordAndPhonetics);

            const wordTitle = createEl('h2', ['text-4xl', 'md:text-5xl', 'font-bold', 'mb-1', 'sm:mb-0', 'capitalize', 'mr-2'], data.word);
            wordAndPhonetics.appendChild(wordTitle);

            const phoneticText = data.phonetic || (data.phonetics && data.phonetics.length > 0 && data.phonetics.find(p => p.text)?.text) || '';
            if (phoneticText) wordAndPhonetics.appendChild(createEl('p', ['text-lg', 'text-indigo-600'], phoneticText));

            const actionsDiv = createEl('div', ['flex', 'items-center', 'gap-4']);
            header.appendChild(actionsDiv);

            // Copy button
            const copyButton = createEl('button', ['w-12', 'h-12', 'flex', 'items-center', 'justify-center', 'rounded-full', 'bg-gray-200', 'hover:bg-gray-300', 'transition-colors', 'duration-200', 'text-gray-600', 'shrink-0', 'text-2xl']);
            copyButton.innerHTML = `ðŸ“‹`;
            copyButton.onclick = () => { navigator.clipboard.writeText(data.word); showMessage('Word copied to clipboard!'); };
            actionsDiv.appendChild(copyButton);

            const audioSource = data.phonetics?.find(p => p.audio)?.audio;
            if(audioSource){
                const audioButton = createEl('button', ['w-12','h-12','flex','items-center','justify-center','rounded-full','bg-indigo-100','hover:bg-indigo-200','transition-colors','duration-200','text-indigo-600','shrink-0','text-2xl']);
                audioButton.innerHTML = `ðŸ”‰`;
                audioButton.onclick = () => { const audio = new Audio(audioSource); audio.play(); };
                actionsDiv.appendChild(audioButton);
            }

            data.meanings.forEach(meaning => {
                const meaningSection = createEl('div', ['mb-6']);
                card.appendChild(meaningSection);

                const partOfSpeechHeader = createEl('h3', ['text-xl', 'font-semibold', 'mb-2', 'flex', 'items-center']);
                partOfSpeechHeader.innerHTML = `<span>${meaning.partOfSpeech}</span><div class="h-px bg-gray-300 flex-grow ml-4"></div>`;
                meaningSection.appendChild(partOfSpeechHeader);

                const definitionsList = createEl('ul', ['list-disc','list-inside','ml-4','space-y-4']);
                meaningSection.appendChild(definitionsList);

                // Display first 3 definitions
                meaning.definitions.slice(0, 3).forEach(def => {
                    const listItem = createEl('li', ['mb-2','p-2','bg-gray-100','rounded-xl']);
                    definitionsList.appendChild(listItem);
                    listItem.appendChild(createEl('p', ['text-lg'], def.definition));
                    if(def.example) listItem.appendChild(createEl('p', ['text-gray-500','mt-1'], `Example: "${def.example}"`));
                });
                
                // Add a dropdown for remaining definitions
                if (meaning.definitions.length > 3) {
                    const dropdownContainer = createEl('div', ['relative', 'mt-4', 'ml-4']);
                    meaningSection.appendChild(dropdownContainer);

                    const dropdownToggle = createEl('button', ['w-full', 'text-left', 'flex', 'items-center', 'justify-between', 'text-sm', 'text-indigo-500', 'hover:text-indigo-700', 'transition-colors', 'duration-200']);
                    dropdownToggle.innerHTML = `Show ${meaning.definitions.length - 3} more definitions <span class="ml-2">â–¼</span>`;
                    dropdownContainer.appendChild(dropdownToggle);

                    const moreDefinitionsList = createEl('ul', ['list-disc','list-inside','ml-4','mt-2','space-y-4', 'hidden']);
                    dropdownContainer.appendChild(moreDefinitionsList);

                    // Add the remaining definitions to the new list
                    meaning.definitions.slice(3).forEach(def => {
                        const listItem = createEl('li', ['mb-2','p-2','bg-gray-100','rounded-xl']);
                        moreDefinitionsList.appendChild(listItem);
                        listItem.appendChild(createEl('p', ['text-lg'], def.definition));
                        if(def.example) listItem.appendChild(createEl('p', ['text-gray-500','mt-1'], `Example: "${def.example}"`));
                    });

                    // Add click event listener to toggle the dropdown
                    dropdownToggle.onclick = () => {
                        const isHidden = moreDefinitionsList.classList.toggle('hidden');
                        dropdownToggle.innerHTML = `Show ${meaning.definitions.length - 3} more definitions <span class="ml-2">${isHidden ? 'â–¼' : 'â–²'}</span>`;
                    };
                }

                if(meaning.synonyms && meaning.synonyms.length>0){
                    const synonymsDiv = createEl('div', ['mt-4']);
                    synonymsDiv.innerHTML = `<h4 class="font-medium text-gray-500">Synonyms:</h4>`;
                    const synonymsList = createEl('div', ['mt-2','flex','flex-wrap','gap-2']);
                    meaning.synonyms.forEach(syn => { 
                        const synonymButton = createEl('button', ['px-3', 'py-1', 'rounded-full', 'bg-gray-200', 'text-sm', 'text-gray-600', 'hover:bg-gray-300', 'transition-colors', 'duration-200']);
                        synonymButton.textContent = syn;
                        synonymButton.onclick = () => {
                            getById('wordInput').value = syn;
                            fetchWordDefinition(syn);
                        };
                        synonymsList.appendChild(synonymButton);
                    });
                    synonymsDiv.appendChild(synonymsList);
                    meaningSection.appendChild(synonymsDiv);
                }
            });
        };

        const wordInput = getById('wordInput');
        const searchButton = getById('searchButton');
        searchButton.addEventListener('click', () => fetchWordDefinition(wordInput.value.trim()));
        wordInput.addEventListener('keyup', e => { if(e.key==='Enter') fetchWordDefinition(wordInput.value.trim()); });
        getById('clearHistoryBtn').addEventListener('click', clearSearchHistory);

        renderSearchHistory();
    </script>
</body>
</html>
